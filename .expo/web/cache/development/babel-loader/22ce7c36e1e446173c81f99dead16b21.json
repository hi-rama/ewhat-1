{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _extends7 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _todolist = _interopRequireDefault(require(\"./layout/todolist\"));\n\nvar _AppTitleHeader = _interopRequireDefault(require(\"./component/AppTitleHeader\"));\n\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-community/async-storage\"));\n\nvar _v = _interopRequireDefault(require(\"uuid/v1\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _jsxFileName = \"D:\\\\merge\\\\please-attendence\\\\App.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar App = function (_React$Component) {\n  (0, _inherits2.default)(App, _React$Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, App);\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      _reactNative.AppState.addEventListener('change', _this._handleAppStateChange);\n\n      _this._loadTodos();\n    };\n\n    _this.componentWillUnmount = function () {\n      _reactNative.AppState.removeEventListener('change', _this._handleAppStateChange);\n    };\n\n    _this._handleAppStateChange = function (nextAppState) {\n      if (nextAppState === 'background') {\n        _this._saveTodo(_this.state.todos);\n      }\n\n      _this.setState({\n        appState: nextAppState\n      });\n    };\n\n    _this._saveTodo = function (newTodos) {\n      _asyncStorage.default.setItem('todos', JSON.stringify(newTodos));\n    };\n\n    _this._loadTodos = function _callee() {\n      var getSavedTodos, savedTodos, expiredTodos;\n      return _regenerator.default.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regenerator.default.awrap(_asyncStorage.default.getItem('todos'));\n\n            case 3:\n              getSavedTodos = _context.sent;\n              savedTodos = JSON.parse(getSavedTodos);\n              savedTodos = savedTodos === null ? {} : savedTodos;\n              _context.next = 8;\n              return _regenerator.default.awrap(_this._findExpiredTodo(savedTodos));\n\n            case 8:\n              expiredTodos = _context.sent;\n\n              _this.setState({\n                todos: savedTodos,\n                expiredTodos: expiredTodos\n              });\n\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 12]], Promise);\n    };\n\n    _this._addTodo = function (newTodoTitle) {\n      var _id = (0, _v.default)();\n\n      var now = (0, _moment.default)().format('YYYY[-]MM[-]DD');\n      var newTodo = (0, _defineProperty2.default)({}, _id, {\n        id: _id,\n        title: newTodoTitle !== '' ? newTodoTitle : 'New Todo Title',\n        description: '',\n        dueDate: '',\n        createdAt: now,\n        priority: '3',\n        isCompleted: false\n      });\n\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, newTodo)\n        });\n        newState.expiredTodos = _this._findExpiredTodo(newState.todos);\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._deleteTodo = function (id) {\n      _this.setState(function (prevState) {\n        var todos = prevState.todos;\n        delete todos[id];\n        var newState = (0, _extends7.default)({}, prevState, todos);\n        newState.expiredTodos = _this._findExpiredTodo(newState.todos);\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._deleteManyTodo = function (todoList) {\n      _this.setState(function (prevState) {\n        var todos = prevState.todos;\n        todoList.map(function (todo) {\n          delete todos[todo.id];\n        });\n        var newState = (0, _extends7.default)({}, prevState, todos);\n        newState.expiredTodos = _this._findExpiredTodo(newState.todos);\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._completeToggle = function (id, currentCompleteState) {\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, (0, _defineProperty2.default)({}, id, (0, _extends7.default)({}, prevState.todos[id], {\n            isCompleted: !currentCompleteState\n          })))\n        });\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._changeTitleText = function (id, text) {\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, (0, _defineProperty2.default)({}, id, (0, _extends7.default)({}, prevState.todos[id], {\n            title: text\n          })))\n        });\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._changeDescriptionText = function (id, text) {\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, (0, _defineProperty2.default)({}, id, (0, _extends7.default)({}, prevState.todos[id], {\n            description: text\n          })))\n        });\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._changePriority = function (id, prior) {\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, (0, _defineProperty2.default)({}, id, (0, _extends7.default)({}, prevState.todos[id], {\n            priority: prior\n          })))\n        });\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._changeDueDate = function (id, date) {\n      _this.setState(function (prevState) {\n        var newState = (0, _extends7.default)({}, prevState, {\n          todos: (0, _extends7.default)({}, prevState.todos, (0, _defineProperty2.default)({}, id, (0, _extends7.default)({}, prevState.todos[id], {\n            dueDate: date\n          })))\n        });\n        newState.expiredTodos = _this._findExpiredTodo(newState.todos);\n        return (0, _extends7.default)({}, newState);\n      });\n    };\n\n    _this._findExpiredTodo = function (todos) {\n      var now = new Date();\n      var expired = [];\n      Object.values(todos).map(function (todo) {\n        if (todo.dueDate !== '') {\n          var splited = todo.dueDate.split('-');\n          var dueDate = new Date(splited[0], splited[1] - 1, splited[2], 23, 59, 59);\n\n          if (dueDate < now) {\n            expired.push(todo);\n          }\n        }\n      });\n      return expired;\n    };\n\n    _this.state = {\n      appState: _reactNative.AppState.currentState,\n      expiredTodos: [],\n      todos: {}\n    };\n    return _this;\n  }\n\n  (0, _createClass2.default)(App, [{\n    key: \"render\",\n    value: function render() {\n      return _react.default.createElement(_reactNative.View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 7\n        }\n      }, _react.default.createElement(_reactNative.StatusBar, {\n        barStyle: \"light-content\",\n        backgroundColor: \"#5c3735\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 9\n        }\n      }), _react.default.createElement(_AppTitleHeader.default, {\n        expiredTodos: this.state.expiredTodos,\n        deleteTodo: this._deleteTodo,\n        deleteManyTodo: this._deleteManyTodo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 9\n        }\n      }), _react.default.createElement(_todolist.default, {\n        todos: this.state.todos,\n        addTodo: this._addTodo,\n        deleteTodo: this._deleteTodo,\n        completeStateToggle: this._completeToggle,\n        changeTitleText: this._changeTitleText,\n        changeDescriptionText: this._changeDescriptionText,\n        changePriority: this._changePriority,\n        changeDueDate: this._changeDueDate,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n  return App;\n}(_react.default.Component);\n\nexports.default = App;\n\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#252525',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"sources":["D:/merge/please-attendence/App.js"],"names":["App","props","componentDidMount","AppState","addEventListener","_handleAppStateChange","_loadTodos","componentWillUnmount","removeEventListener","nextAppState","_saveTodo","state","todos","setState","appState","newTodos","AsyncStorage","setItem","JSON","stringify","getItem","getSavedTodos","savedTodos","parse","_findExpiredTodo","expiredTodos","console","log","_addTodo","newTodoTitle","_id","now","format","newTodo","id","title","description","dueDate","createdAt","priority","isCompleted","prevState","newState","_deleteTodo","_deleteManyTodo","todoList","map","todo","_completeToggle","currentCompleteState","_changeTitleText","text","_changeDescriptionText","_changePriority","prior","_changeDueDate","date","Date","expired","Object","values","splited","split","push","currentState","styles","container","React","Component","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {StyleSheet, View, StatusBar, AppState} from 'react-native';\r\nimport TodoList from './layout/todolist';\r\nimport AppTitleHeader from './component/AppTitleHeader';\r\nimport AsyncStorage from '@react-native-community/async-storage';\r\nimport uuid from 'uuid/v1';\r\nimport moment from 'moment';\r\n\r\nexport default class App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      appState: AppState.currentState,\r\n      expiredTodos: [],\r\n      todos: {},\r\n    };\r\n  }\r\n\r\n  // when app component first loaded, load to saved todos and tracking app state\r\n  componentDidMount = () => {\r\n    AppState.addEventListener('change', this._handleAppStateChange);\r\n    this._loadTodos();\r\n  };\r\n\r\n  // when app closed, remove app state changed event listener\r\n  componentWillUnmount = () => {\r\n    AppState.removeEventListener('change', this._handleAppStateChange);\r\n  };\r\n\r\n  // when app state is background, save current todos to asyncStorage (local storage)\r\n  _handleAppStateChange = nextAppState => {\r\n    if (nextAppState === 'background') {\r\n      this._saveTodo(this.state.todos);\r\n    }\r\n    this.setState({appState: nextAppState});\r\n  };\r\n\r\n  // save current todos to asyncStorage\r\n  _saveTodo = newTodos => {\r\n    AsyncStorage.setItem('todos', JSON.stringify(newTodos));\r\n  };\r\n\r\n  // load saved todos from asyncStorage\r\n  _loadTodos = async () => {\r\n    try {\r\n      const getSavedTodos = await AsyncStorage.getItem('todos');\r\n      let savedTodos = JSON.parse(getSavedTodos);\r\n      savedTodos = savedTodos === null ? {} : savedTodos; // null check\r\n      const expiredTodos = await this._findExpiredTodo(savedTodos); // search expired todos\r\n      this.setState({todos: savedTodos, expiredTodos: expiredTodos});\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  // callback function\r\n  // if you want add new todo in todo list, call this function from child\r\n  _addTodo = newTodoTitle => {\r\n    const _id = uuid(); // name(id) each todo element in todos\r\n    const now = moment().format('YYYY[-]MM[-]DD');\r\n    const newTodo = {\r\n      [_id]: {\r\n        id: _id,\r\n        title: newTodoTitle !== '' ? newTodoTitle : 'New Todo Title',\r\n        description: '',\r\n        dueDate: '',\r\n        createdAt: now,\r\n        priority: '3',\r\n        isCompleted: false,\r\n      },\r\n    };\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          ...newTodo,\r\n        },\r\n      };\r\n      newState.expiredTodos = this._findExpiredTodo(newState.todos);\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if you want delete one todo, call this function from child\r\n  _deleteTodo = id => {\r\n    this.setState(prevState => {\r\n      const todos = prevState.todos;\r\n      delete todos[id];\r\n      const newState = {\r\n        ...prevState,\r\n        ...todos,\r\n      };\r\n      newState.expiredTodos = this._findExpiredTodo(newState.todos);\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if you want delete many todos, call this function from child\r\n  _deleteManyTodo = todoList => {\r\n    this.setState(prevState => {\r\n      const todos = prevState.todos;\r\n      todoList.map(todo => {\r\n        delete todos[todo.id];\r\n      });\r\n      const newState = {\r\n        ...prevState,\r\n        ...todos,\r\n      };\r\n      newState.expiredTodos = this._findExpiredTodo(newState.todos);\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if child component's complete state changed, call this function from child\r\n  _completeToggle = (id, currentCompleteState) => {\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          [id]: {\r\n            ...prevState.todos[id],\r\n            isCompleted: !currentCompleteState,\r\n          },\r\n        },\r\n      };\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if child component's title text changed, call this function from child\r\n  _changeTitleText = (id, text) => {\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          [id]: {\r\n            ...prevState.todos[id],\r\n            title: text,\r\n          },\r\n        },\r\n      };\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if child component's description changed, call this function from child\r\n  _changeDescriptionText = (id, text) => {\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          [id]: {\r\n            ...prevState.todos[id],\r\n            description: text,\r\n          },\r\n        },\r\n      };\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if child component's priority changed, call this function from child\r\n  _changePriority = (id, prior) => {\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          [id]: {\r\n            ...prevState.todos[id],\r\n            priority: prior,\r\n          },\r\n        },\r\n      };\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // callback function\r\n  // if child component's due date changed, call this function from child\r\n  _changeDueDate = (id, date) => {\r\n    this.setState(prevState => {\r\n      const newState = {\r\n        ...prevState,\r\n        todos: {\r\n          ...prevState.todos,\r\n          [id]: {\r\n            ...prevState.todos[id],\r\n            dueDate: date,\r\n          },\r\n        },\r\n      };\r\n      newState.expiredTodos = this._findExpiredTodo(newState.todos);\r\n      return {...newState};\r\n    });\r\n  };\r\n\r\n  // find Expired Todos in new state of todos\r\n  _findExpiredTodo = todos => {\r\n    let now = new Date();\r\n    let expired = [];\r\n    Object.values(todos).map(todo => {\r\n      if (todo.dueDate !== '') {\r\n        // convert date string to date type object\r\n        let splited = todo.dueDate.split('-');\r\n        let dueDate = new Date(\r\n          splited[0],\r\n          splited[1] - 1,\r\n          splited[2],\r\n          23,\r\n          59,\r\n          59,\r\n        );\r\n        if (dueDate < now) {\r\n          expired.push(todo);\r\n        }\r\n      }\r\n    });\r\n    return expired;\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <View style={styles.container}>\r\n        <StatusBar barStyle=\"light-content\" backgroundColor=\"#5c3735\" />\r\n        <AppTitleHeader\r\n          expiredTodos={this.state.expiredTodos}\r\n          deleteTodo={this._deleteTodo}\r\n          deleteManyTodo={this._deleteManyTodo}\r\n        />\r\n        <TodoList\r\n          todos={this.state.todos}\r\n          addTodo={this._addTodo}\r\n          deleteTodo={this._deleteTodo}\r\n          completeStateToggle={this._completeToggle}\r\n          changeTitleText={this._changeTitleText}\r\n          changeDescriptionText={this._changeDescriptionText}\r\n          changePriority={this._changePriority}\r\n          changeDueDate={this._changeDueDate}\r\n        />\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#252525',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"script"}